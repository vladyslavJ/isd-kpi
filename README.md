# –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏–π —á–∞—Ç –Ω–∞ WebSocket

## –û–≥–ª—è–¥

–¶–µ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —á–∞—Ç—É, —è–∫–∏–π –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –¥–≤–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ–±–º—ñ–Ω –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ –º—ñ–∂ –±—Ä–∞—É–∑–µ—Ä–æ–º —ñ —Å–µ—Ä–≤–µ—Ä–æ–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–æ—Ç–æ–∫–æ–ª—É **WebSocket**.  –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ–±—É–¥–æ–≤–∞–Ω–∞ –Ω–∞ **Node.js + Express + TypeScript** —ñ–∑ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è–º –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ **Socket.IO**.

> **–û—Å–æ–±–ª–∏–≤—ñ—Å—Ç—å**: —É—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è¬†–≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ñ–π –ø–∞–º º—è—Ç—ñ (–º–∞—Å–∏–≤ `messages[]`), —Ç–æ–º—É –±–∞–∑–∞¬†–¥–∞–Ω–∏—Ö –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞ ‚Äî —Ü—å–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏.

---

## –û—Å–Ω–æ–≤–Ω–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

| ¬†#¬† | –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å                                            | –î–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ                          |
| :-: | ----------------------------------------------------- | --------------------------------------- |
|  1  | –ü—ñ–¥ º—î–¥–Ω–∞–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—ñ–≤ —á–µ—Ä–µ–∑ WebSocket                  | `src/server.ts`, `src/sockets/chat.ts`  |
|  2  | –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ  | `chat.ts`¬†‚áÑ¬†`public/js/client.js`       |
|  3  | –¢—Ä–∞–Ω—Å–ª—è—Ü—ñ—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—Å—ñ–º –ø—ñ–¥ º—î–¥–Ω–∞–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º | `io.emit('chat message',¬†‚Ä¶)`            |
|  4  | –ü–µ—Ä–µ–¥–∞–≤–∞–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó —á–∞—Ç—É –Ω–æ–≤–æ–º—É –∫–ª—ñ—î–Ω—Ç—É               | `socket.emit('chat history',¬†messages)` |

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
lab6/
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ nodemon.json          # –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —É dev‚Äë—Ä–µ–∂–∏–º—ñ
‚îÇ
‚îî‚îÄ‚îÄ src/
    ‚îú‚îÄ‚îÄ app.ts            # –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Express
    ‚îú‚îÄ‚îÄ server.ts         # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É, HTTP¬†+¬†Socket.IO
    ‚îÇ
    ‚îú‚îÄ‚îÄ sockets/
    ‚îÇ   ‚îî‚îÄ‚îÄ chat.ts       # –ª–æ–≥—ñ–∫–∞ WebSocket‚Äë–ø–æ–¥—ñ–π
    ‚îÇ
    ‚îî‚îÄ‚îÄ public/           # —Å—Ç–∞—Ç–∏—á–Ω–∏–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
        ‚îú‚îÄ‚îÄ index.html
        ‚îú‚îÄ‚îÄ css/
        ‚îÇ   ‚îî‚îÄ‚îÄ styles.css
        ‚îî‚îÄ‚îÄ js/
            ‚îî‚îÄ‚îÄ client.js
```

> –ü—ñ—Å–ª—è –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó TypeScript‚Äë–∫–æ–¥—É –∑ º—è–≤–ª—è—î—Ç—å—Å—è –ø–∞–ø–∫–∞¬†`dist/` —ñ–∑ —Ç–∞–∫–æ—é —Å–∞–º–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é.

---

## –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1. –ö–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∞–±–æ —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥:

   ```bash
   git clone https://github.com/vladyslavJ/isd-kpi.git
   cd lab6
   ```
2. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:

   ```bash
   npm install
   ```

---

## –ó–∞–ø—É—Å–∫

### üîÑ  –†–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–∫–∏ (–¥–≤—ñ –æ–ø—Ü—ñ—ó)

| –í–∞—Ä—ñ–∞–Ω—Ç                     | –ö–æ–º–∞–Ω–¥–∞                        | –ü–æ—è—Å–Ω–µ–Ω–Ω—è                                                                                                                                                         |
| --------------------------- | ------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **A**. `ts-node` –±–µ–∑ –∑–±—ñ—Ä–∫–∏ | `npm run dev`                  | `nodemon` –≤—ñ–¥—Å–ª—ñ–¥–∫–æ–≤—É—î¬†`.ts`‚Äë—Ñ–∞–π–ª–∏ –π –∑–∞–ø—É—Å–∫–∞—î —ó—Ö –Ω–∞–ø—Ä—è–º—É —á–µ—Ä–µ–∑ **ts-node**. –°—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏ —á–∏—Ç–∞—é—Ç—å—Å—è –ø—Ä—è–º–æ –∑ `src/public`, —Ç–æ–º—É –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–µ.           |
| **B**. `tsc¬†+¬†cpx`          | `npm run build`<br>`npm start` | –°–∫—Ä–∏–ø—Ç `build` –∫–æ–º–ø—ñ–ª—é—î **TypeScript** —É `dist/` —ñ –∫–æ–ø—ñ—é—î —Ç—É–¥–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (`cpx "src/public/**/*" dist/public`). –î–∞–ª—ñ `npm start` –∑–∞–ø—É—Å–∫–∞—î –≤–∂–µ –∑—ñ–±—Ä–∞–Ω–∏–π JavaScript. |

> –ü—ñ—Å–ª—è —Å—Ç–∞—Ä—Ç—É –≤—ñ–¥–∫—Ä–∏–π—Ç–µ **[http://localhost:3000](http://localhost:3000)** ‚Äî —á–∞—Ç –º–∞—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –æ–¥—Ä–∞–∑—É –≤¬†—É—Å—ñ—Ö –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –≤–∫–ª–∞–¥–∫–∞—Ö/–±—Ä–∞—É–∑–µ—Ä–∞—Ö.

### ‚öôÔ∏è  –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—É

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Å–µ—Ä–≤–µ—Ä —Å–ª—É—Ö–∞—î **3000**.  –©–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –ø–æ—Ä—Ç, —É–∫–∞–∂—ñ—Ç—å –∑–º—ñ–Ω–Ω—É¬†—Å–µ—Ä–µ–¥–æ–≤–∏—â–∞:

```bash
PORT=8080 npm run dev     # –∞–±–æ npm start
```

---

## –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î (–ø–æ—Ç—ñ–∫ –ø–æ–¥—ñ–π)

1. **–ö–ª—ñ—î–Ω—Ç** (–±—Ä–∞—É–∑–µ—Ä) –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î `index.html`, CSS —ñ `client.js`.
2. `client.js` —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î¬†`io()`¬†‚Äî –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è WebSocket‚Äë–∑ º—î–¥–Ω–∞–Ω–Ω—è.
3. –ù–∞ –±–æ—Ü—ñ **—Å–µ—Ä–≤–µ—Ä–∞**¬†`src/server.ts` —Å—Ç–≤–æ—Ä—é—î HTTP‚Äë—Å–µ—Ä–≤–µ—Ä, –ø—ñ–¥ º—î–¥–Ω—É—î **Socket.IO** —Ç–∞ –¥–µ–ª–µ–≥—É—î –ª–æ–≥—ñ–∫—É –≤¬†`chat.ts`.
4. –£¬†`chat.ts`:

   * –ø—Ä–∏ `connection` –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –º–∞—Å–∏–≤ **—ñ—Å—Ç–æ—Ä—ñ—ó** (`chat history`);
   * –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ `chat message`¬†‚Äî –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –æ–±–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è¬†—Ç–∞–π–º—Å—Ç–∞–º–ø–æ–º, –¥–æ–¥–∞—î—Ç—å—Å—è –≤¬†–º–∞—Å–∏–≤ —ñ —Ç—Ä–∞–Ω—Å–ª—é—î—Ç—å—Å—è (`io.emit`) —É—Å—ñ–º –∫–ª—ñ—î–Ω—Ç–∞–º.
5. **–ö–ª—ñ—î–Ω—Ç–∏** —Å–ª—É—Ö–∞—é—Ç—å –ø–æ–¥—ñ—ó `chat history` —Ç–∞ `chat message`, —Ä–µ–Ω–¥–µ—Ä—è—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É¬†—Å–ø–∏—Å–∫—É¬†`<ul id="messages">`.

---

## –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

| –ü–∞–∫–µ—Ç       | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è                                  |
| ----------- | -------------------------------------------- |
| `express`   | HTTP‚Äë—Å–µ—Ä–≤–µ—Ä + –≤—ñ–¥–¥–∞—á–∞ —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤       |
| `socket.io` | –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è WebSocket‚Äë—Ä—ñ–≤–Ω—è (—Å–µ—Ä–≤–µ—Ä + –∫–ª—ñ—î–Ω—Ç) |

**Dev‚Äëdependencies**: `typescript`, `ts-node`, `nodemon`, `cpx`, `@types/node`, `@types/express`.

